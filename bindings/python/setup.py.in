from setuptools import setup, find_packages
from setuptools.extension import Extension
from setuptools import Distribution
import numpy


def cythonize(*args, **kwargs):
    from Cython.Build import cythonize
    return cythonize(*args, **kwargs)

extensions = [
    Extension("sleqp.sleqp_python_extension",
              ['src/sleqp_python_extension.pyx'],
              include_dirs=[numpy.get_include(),
                            '@SLEQP_INCLUDE_DIR@',
                            '@CMAKE_BINARY_DIR@'],
              libraries=['sleqp'],
              library_dirs=['@SLEQP_LIBRARY_DIR@']
    )]

requirements = []

Distribution().fetch_build_eggs(['Cython'])

with open('requirements.txt') as f:
    requirements = f.read().splitlines()

setup(name='@PROJECT_NAME@',
      version='@PROJECT_VERSION@',
      ext_modules=cythonize(extensions),
      packages=find_packages(exclude=["tests"]),
      install_requires=requirements,
      classifiers=[
        'Programming Language :: Cython',
        'Intended Audience :: Science/Research',
        'Topic :: Scientific/Engineering :: Mathematics'
      ],
      test_suite='tests')
