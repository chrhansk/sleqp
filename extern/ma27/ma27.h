/**
 * @file ma27.h
 * @brief      MA27 Header File
 * @author     Christian Kirches All documentation is abridged and taken from
 *             the HSL 2002 package specification documents for MA27.
 *
 *             References:
 *  -# Duff and Reid, ACM Trans. Math. Software, vol. 9 (1983), pp. 302--325
 */

#pragma once
#ifndef _GLUE_MA27_H_INCLUDED_
#define _GLUE_MA27_H_INCLUDED_

#ifdef __cplusplus
extern "C" {
#endif

#include "util_types.h"
    
/**
 * @brief      Sets default values for the components of the arrays that hold
 *             control parameters.
 *
 *             Normally the user will call MA27I/ID prior to any call to
 *             MA27A/AD. If non- default values for any of the control
 *             parameters are required, they should be set immediately after the
 *             call to MA27I/ID.
 *
 * @param      icntl  an INTEGER array of length 20 that need not be set by the
 *                    user. On return it contains default values.
 * @param      cntl   a double PRECISION array of length 5 that need not be set
 *                    by the user. On return it contains default values.
 */
extern void 
ma27id_ (
    fint_t  *icntl,
    double *cntl
);

/**
 * @brief      Accepts the pattern of A and chooses pivots for Gaussian
 *             elimination.
 *
 *             MA27A/AD accepts the pattern of A and chooses pivots for Gaussian
 *             elimination using a selection criterion to preserve sparsity. It
 *             subsequently constructs subsidiary information for actual
 *             factorization by MA27B/BD. The user may input the pivot sequence
 *             in which case only the necessary information for MA27B/BD will be
 *             generated.
 *
 * @param[in]  n       { parameter_description }
 * @param[in]  nz      { parameter_description }
 * @param[in]  irn     The irn
 * @param[in]  icn     The icn
 * @param      iw      { parameter_description }
 * @param[in]  liw     The liw
 * @param      ikeep   The ikeep
 * @param      iw1     The iw 1
 * @param      nsteps  The nsteps
 * @param[in]  iflag   The iflag
 * @param      icntl   The icntl
 * @param      cntl    The cntl
 * @param      info    The information
 * @param      ops     The ops
 */
extern void 
ma27ad_ (
    const fint_t *n,
    const fint_t *nz,
    const fint_t *irn,
    const fint_t *icn,
    fint_t       *iw,
    const fint_t *liw,
    fint_t       *ikeep,
    fint_t       *iw1,
    fint_t       *nsteps,
    const fint_t *iflag,
    fint_t       *icntl,
    double      *cntl,
    fint_t       *info,
    double      *ops     
);

/**
 * @brief      Factorizes a matrix A
 *
 *             Uses the information from a previous call to MA27A/AD. The actual
 *             pivot sequence used may differ from that of MA27A/AD if A is not
 *             definite.
 *
 * @param[in]  n       { parameter_description }
 * @param[in]  nz      { parameter_description }
 * @param[in]  irn     The irn
 * @param[in]  icn     The icn
 * @param      a       { parameter_description }
 * @param[in]  la      { parameter_description }
 * @param      iw      { parameter_description }
 * @param[in]  liw     The liw
 * @param[in]  ikeep   The ikeep
 * @param[in]  nsteps  The nsteps
 * @param      maxfrt  The maxfrt
 * @param      iw1     The iw 1
 * @param      icntl   The icntl
 * @param      cntl    The cntl
 * @param      info    The information
 */
extern void 
ma27bd_ (
    const fint_t *n,
    const fint_t *nz,
    const fint_t *irn,
    const fint_t *icn,
    double      *a,
    const fint_t *la,
    fint_t       *iw,
    const fint_t *liw,
    const fint_t *ikeep,
    const fint_t *nsteps,
    fint_t       *maxfrt,
    fint_t       *iw1,
    fint_t       *icntl,
    double      *cntl,
    fint_t       *info
);

/**
 * @brief      Solve a system of equations Ax=b (AX=B).
 *
 *             Uses the factors generated by MA27B/BD to solve a system of
 *             equations Ax=b (AX=B) using iterative refinement and (optionally)
 *             returning estimates of the error.
 *
 * @param[in]  n       { parameter_description }
 * @param[in]  a       { parameter_description }
 * @param[in]  la      { parameter_description }
 * @param[in]  iw      { parameter_description }
 * @param[in]  liw     The liw
 * @param      w       { parameter_description }
 * @param[in]  maxfrt  The maxfrt
 * @param      x_rhs   The x right hand side
 * @param      iw1     The iw 1
 * @param[in]  nsteps  The nsteps
 * @param      icntl   The icntl
 * @param      info    The information
 */
extern void 
ma27cd_ (
    const fint_t  *n,
    const double *a,
    const fint_t  *la,
    const fint_t  *iw,
    const fint_t  *liw,
    double       *w,
    const fint_t  *maxfrt,
    double       *x_rhs,
    fint_t        *iw1,
    const fint_t  *nsteps,
    fint_t        *icntl,
    fint_t        *info
);

#ifdef __cplusplus
}
#endif

#endif // _GLUE_MA27_H_INCLUDED_
